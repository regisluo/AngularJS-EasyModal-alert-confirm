angular.module("emodalService",[]).factory("emodal",["$document","$compile","$rootScope","$controller","$timeout",function(l,a,e,n,t){var o={},c=l.find("body"),s={id:null,title:null,template:null,templateClass:null,templateUrl:null,footerTemplate:null,backdrop:!0,backdropClass:"modal-backdrop",backdropCancel:!0,okLabel:"OK",okClass:"btn btn-primary",okShow:!0,okCallback:null,okCallbackObj:null,okArgs:null,cancelLabel:"Cancel",cancelClass:"btn",cancelShow:!1,cancelCallback:null,cancelCallbackObj:null,cancelArgs:null,fadein:null,modalClass:"modal",controller:null,css:{top:"30%",margin:"0 auto"}};return o.alert=function(){if(arguments[0]instanceof Object)this.modal(arguments[0],"alert");else{var l={};l.template=arguments[0],angular.isString(arguments[1])?l.okLabel=arguments[1]:angular.isNumber(arguments[1])&&(l.fadein=arguments[1]),angular.isNumber(arguments[2])&&(l.fadein=arguments[2]),this.modal(l,"alert")}},o.confirm=function(){if(arguments[0]instanceof Object)this.modal(arguments[0],"confirm");else{var l={};l.template=arguments[0],l.okCallback=arguments[1],l.cancelCallback=arguments[2],l.okCallbackObj=arguments[3],l.cancelCallbackObj=arguments[4],l.cancelShow=!0,this.modal(l,"confirm")}},o.modal=function(l,o,d){var r=!1,m=!1;arguments.length>0?(angular.isObject(l)?(d=o,o=l,"alert"==d&&(r=!0),"confirm"==d&&(m=!0)):(o=null==o?{}:o,o.templateUrl=l),o=angular.extend({},s,o)):o=s;var i=o.id?' id="'+o.id+'" ':"";var u="";(o.okShow||o.okCallback)&&(u+='<button class="'+o.okClass+'" ng-click="$modalOK()">{{$modalOKLabel}}</button>'),(o.cancelShow||o.cancelCallback)&&(u+='<button class="'+o.cancelClass+'" ng-click="$modalCancel()">{{$modalCancelLabel}}</button>');var b='<div class="modal-footer">'+(o.footerTemplate||u)+"</div>";r&&(o.templateClass=null==o.templateClass?"alert alert-info":o.templateClass),m&&(o.templateClass=null==o.templateClass?"alert alert-danger":o.templateClass);var k=function(){return o.template?angular.isString(o.template)?'<div class="modal-body '+o.templateClass+'">'+o.template+"</div>":'<div class="modal-body">'+o.template.html()+"</div>":o.templateUrl?'<div class="modal-body" ng-include="\''+o.templateUrl+"'\"></div>":'<div class="modal-body"></div>'}(),C='<div class="'+o.modalClass+' fade"'+i+' style="display: block;">';C+=r||m?'  <div class="modal-dialog modal-sm">    <div class="modal-content">':'  <div class="modal-dialog">    <div class="modal-content">',C+=o.title?'      <div class="modal-header">        <button type="button" class="close" ng-click="$modalCancel()">&times;</button>        <h3>{{$title}}</h3>      </div>':r||m?'      <div class="modal-header"></div>':'      <div class="modal-header">        <button type="button" class="close" ng-click="$modalCancel()">&times;</button>      </div>',C+=k+b+"    </div>  </div></div>";var g=angular.element(C);for(key in o.css)g.css(key,o.css[key]);var p="<div ";o.backdropCancel&&(p+='ng-click="$modalCancel()"'),p+=">";var v=angular.element(p);v.addClass(o.backdropClass),v.addClass("fade in");var f=function(l){27===l.keyCode&&O.$modalCancel()},$=function(){c.unbind("keydown",f),g.remove(),o.backdrop&&v.remove()};c.bind("keydown",f);var y,h,O=o.scope||e.$new();O.$title=o.title,O.$modalOK=function(){o.okCallback&&o.okCallback.call(o.okCallbackObj,o.okArgs),$()},O.$modalCancel=function(){o.cancelCallback&&o.cancelCallback.call(o.cancelCallbackObj,o.cancelArgs),$()},O.$modalOKLabel=o.okLabel,O.$modalCancelLabel=o.cancelLabel,o.controller&&(h=angular.extend({$scope:O},d),y=n(o.controller,h),g.contents().data("$ngControllerController",y)),a(g)(O),a(v)(O),c.append(g),o.backdrop&&c.append(v),o.fadein&&t(function(){$()},o.fadein),t(function(){g.addClass("in")},200)},o}]);